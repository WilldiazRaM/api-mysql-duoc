<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ferreterias FerreMax</title>
    <!-- Agrega tus estilos CSS aquí -->
    <link rel="stylesheet" href="/style.css">
    <!-- Agrega el framework de Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/fontawesome.min.css"
    integrity="sha384-QYIZto+st3yW+o8+5OHfT6S482Zsvz2WfOzpFSXMF9zqeLcFV0/wlZpMtyFcZALm" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>
<style>
    .container {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        background-size: cover;
    }
    .card {
        padding: 20px;
        width: 100%;
        max-width: 400px;
        /* Fondo opaco */
        background-color: rgba(255, 255, 255, 0.8);
        border: solid 2px greenyellow ;
    }
</style>
<body class="bg-dark ">
    <div class="container">
        <div class="card">
            <h1 class="text-center">Inicio de sesión</h1>
            <form id="loginForm">
                <div class="mb-3">
                    <label for="email" class="form-label">Email</label>
                    <input type="email" class="form-control" id="email" name="email" required>
                </div>
                <div class="mb-3">
                    <label for="userPassword" class="form-label">Password</label>
                    <input type="password" class="form-control" id="userPassword" name="userPassword" autocomplete="new-password" required>
                </div>
                <button type="submit" class="btn btn-primary w-100">Login</button>
            </form>
            <hr>
            <a href="/auth/google" class="btn btn-success w-100 mb-2">Login with Google <i class="fa-brands fa-google fa-bounce fa-lg" style="color: #e40101;"></i></a>
            <a href="/auth/github" class="btn btn-dark w-100">Login with GitHub <i class="fa-brands fa-github fa-bounce fa-lg" style="color: #ffffff;"></i></a>
        </div>
    </div>
    <script src="https://kit.fontawesome.com/1dfe34419e.js" crossorigin="anonymous"></script>
    <script>
        document.getElementById('loginForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('userPassword').value;

            try {
                const response = await fetch('/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-email': email,
                        'x-password': password
                    }
                });

                const data = await response.json();
                if (response.ok) {
                    alert('Login successful');
                    // Guardar el token en localStorage
                    localStorage.setItem('token', data.token);
                    // Redirigir al usuario a la página de perfil
                    window.location.href = `/profile?token=${data.token}`;
                } else {
                    alert('Login failed: ' + data.error);
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Login failed: ' + error.message);
            }
        }); 
    </script>
</body>
</html>
